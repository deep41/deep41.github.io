import{j as c}from"./jsx-runtime.W-1L_9JS.js";import{r as f}from"./index.BnJ13_gZ.js";const T={1:[[[0,0],[0,1],[0,2],[0,3]],[[0,0],[1,0],[2,0],[3,0]]],2:[[[0,0],[0,1],[1,0],[1,1]]],3:[[[0,1],[1,0],[1,1],[1,2]],[[0,0],[1,0],[2,0],[1,1]],[[1,0],[1,1],[1,2],[2,1]],[[1,0],[0,1],[1,1],[2,1]]],4:[[[0,1],[0,2],[1,0],[1,1]],[[0,0],[1,0],[1,1],[2,1]]],5:[[[0,0],[0,1],[1,1],[1,2]],[[0,1],[1,0],[1,1],[2,0]]],6:[[[0,1],[1,1],[2,0],[2,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,0],[0,1],[1,0],[2,0]],[[0,0],[0,1],[0,2],[1,2]]],7:[[[0,2],[1,0],[1,1],[1,2]],[[0,0],[1,0],[2,0],[2,1]],[[0,0],[0,1],[0,2],[1,0]],[[0,0],[0,1],[1,1],[2,1]]]},h=(a,d)=>{const t=T[a];return t[d%t.length]},I=a=>({0:"bg-gray-800 dark:bg-gray-700",1:"bg-sky-400 dark:bg-sky-500",2:"bg-amber-400 dark:bg-amber-500",3:"bg-indigo-500 dark:bg-indigo-600",4:"bg-red-400 dark:bg-red-500",5:"bg-fuchsia-500 dark:bg-fuchsia-600",6:"bg-teal-500 dark:bg-teal-600",7:"bg-orange-400 dark:bg-orange-400"})[a],L=a=>({1:100,2:300,3:500,4:800})[a]||0,P=({displayGrid:a})=>c.jsx("div",{className:"grid grid-cols-10 gap-px bg-neutral-700 dark:bg-neutral-600 p-1.5 rounded-lg shadow-lg",children:a.map((d,t)=>d.map((l,u)=>c.jsx("div",{className:`w-6 h-6 rounded-sm transition-colors duration-200 ${I(l)}`},`${t}-${u}`)))}),z=()=>{const[a,d]=f.useState(()=>Array(20).fill(null).map(()=>Array(10).fill(0))),[t,l]=f.useState(null),u=()=>Math.floor(Math.random()*7)+1,[E,N]=f.useState(u()),[b,y]=f.useState(0),[g,k]=f.useState(!0),m=(e,o,i,r)=>h(e,o).every(([s,M])=>{const x=i+s,w=r+M;return w>=0&&w<10&&x<20&&(x<0||a[x][w]===0)}),p=()=>{const e=E;N(u());const o={type:e,rotation:0,row:0,col:3};m(e,0,0,3)?l(o):k(!1)},R=()=>{if(!t)return;const e=a.map(r=>[...r]);h(t.type,t.rotation).forEach(([r,n])=>{const s=t.row+r;s>=0&&(e[s][t.col+n]=t.type)});const i=[];if(e.forEach((r,n)=>{r.every(s=>s!==0)&&i.push(n)}),i.length>0){const r=e.filter((n,s)=>!i.includes(s));for(;r.length<20;)r.unshift(Array(10).fill(0));d(r),y(n=>n+L(i.length))}else d(e);p()},v=()=>{t&&(m(t.type,t.rotation,t.row+1,t.col)?l({...t,row:t.row+1}):R())},S=()=>{t&&m(t.type,t.rotation,t.row,t.col-1)&&l({...t,col:t.col-1})},A=()=>{t&&m(t.type,t.rotation,t.row,t.col+1)&&l({...t,col:t.col+1})},G=()=>{if(!t)return;const e=(t.rotation+1)%T[t.type].length;let o=t.col;if(m(t.type,e,t.row,o)){l({...t,rotation:e});return}const i=h(t.type,e),r=Math.min(...i.map(([,s])=>s)),n=Math.max(...i.map(([,s])=>s));o+r<0?o-=r:o+n>=10&&(o-=o+n-9),m(t.type,e,t.row,o)&&l({...t,rotation:e,col:o})};f.useEffect(()=>{if(!g||!t)return;const e=setInterval(v,1e3);return()=>clearInterval(e)},[t,g]),f.useEffect(()=>{const e=o=>{if(!(!g||!t))switch(o.key){case"ArrowLeft":S();break;case"ArrowRight":A();break;case"ArrowDown":v();break;case"ArrowUp":case" ":G();break}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,g]),f.useEffect(()=>p(),[]);const C=()=>{d(Array(20).fill(null).map(()=>Array(10).fill(0))),y(0);const e=u();l({type:e,rotation:0,row:0,col:3}),setTimeout(()=>{p(),k(!0)},100)},j=a.map(e=>[...e]);return t&&h(t.type,t.rotation).forEach(([o,i])=>{const r=t.row+o,n=t.col+i;r>=0&&r<20&&n>=0&&n<10&&(j[r][n]=t.type)}),c.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 h-[calc(100vh-68px)]",children:[c.jsx("h1",{className:"text-3xl font-bold text-neutral-800 dark:text-neutral-100",children:"Tetris"}),c.jsxs("p",{className:"text-xl font-semibold text-neutral-600 dark:text-neutral-300",children:["Score: ",b]}),c.jsxs("div",{className:"relative",children:[c.jsx(P,{displayGrid:j}),!g&&c.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/60 rounded-lg",children:[c.jsx("h2",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:"Game Over"}),c.jsxs("h2",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:["Final Score: ",b]}),c.jsx("button",{onClick:C,className:"mt-4 px-4 py-2 bg-zinc-600 hover:bg-zinc-700 text-white rounded-lg transition-colors duration-200 font-medium",children:"Restart"})]})]})]})};export{z as default};
